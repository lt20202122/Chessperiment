@import "tailwindcss";
@config "../../tailwind.config.js";
@variant dark (&:where(.dark, .dark *));
@import "tw-animate-css";
@plugin "tailwindcss-animate";

@theme {
  --color-bg: var(--bg);
  --color-islands: var(--islands);
  --color-text: var(--text);
  --color-accent: var(--accent);
  --color-accent-hover: var(--accent-hover);
}

:root {
  /* Common variables */
  --bg: #f2f2f5;
  --islands: #ffffff;
  --text: #111112;
  --accent: #5e5ce6;
  --accent-hover: #4848d1;

  /* Modern oklch values with fallback logic */
  @supports (color: oklch(0% 0 0)) {
    --bg: oklch(95% 0.006 240);
    --islands: oklch(100% 0 0);
    --text: oklch(15% 0.02 240);
    --accent: oklch(58% 0.18 250);
    --accent-hover: oklch(53% 0.18 250);
  }
}

.dark {
  --bg: #1c1c1e;
  --islands: #2c2c2e;
  --text: #e5e5e7;
  --accent: oklch(68.1% 0.162 75.834);
  --accent-hover: oklch(79.5% 0.184 86.047);

  @supports (color: oklch(0% 0 0)) {
    --accent: oklch(68.1% 0.162 75.834);
    --accent-hover: oklch(79.5% 0.184 86.047);
  }
}

body {
  background-color: var(--bg);
  /* Simplify background to prevent GPU glitches on mobile */
  background-image: none;
  background-attachment: scroll;
}

/* Only apply complex gradients on larger screens with better GPUs */
@media (min-width: 1024px) {
  body {
    background-image:
      radial-gradient(circle at center, transparent 0%, var(--bg) 100%),
      linear-gradient(hsla(240, 10%, 50%, 0.1) 1px, transparent 1px),
      linear-gradient(90deg, hsla(240, 10%, 50%, 0.1) 1px, transparent 1px);
    background-size:
      100% 100%,
      40px 40px,
      40px 40px;
    background-attachment: fixed;
  }
}

/* Performance optimizations for mobile */
@media (max-width: 1023px) {
  :root {
    --bg: #f5f5f7 !important;
    --islands: #ececef !important;
  }

  .dark {
    --bg: #1c1c1e !important;
    --islands: #2c2c2e !important;
  }

  * {
    /* Disable transitions on mobile to prevent lag during page load/layout shifts */
    transition-duration: 0.01ms !important;
    animation-duration: 0.01ms !important;
  }

  /* Restore animation duration for spinner animations */
  .animate-spin,
  .animate-spin-slow,
  .animate-pulse,
  .animate-bounce {
    animation-duration: revert !important;
  }

  .backdrop-blur-sm,
  .backdrop-blur-md,
  .backdrop-blur-lg,
  .backdrop-blur-xl,
  .backdrop-blur-2xl {
    /* Disable expensive backdrop-blur on mobile */
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }

  body {
    transition: none !important;
  }

  /* Use solid backgrounds instead of transparent ones when blur is disabled */
  .bg-white\/30,
  .bg-white\/50,
  .bg-primary-island {
    background-color: var(--islands) !important;
  }

  .dark .bg-stone-900\/30,
  .dark .bg-stone-900\/50 {
    background-color: var(--islands) !important;
  }
}

.shadow-islands:hover {
  box-shadow:
    2.5px 2px 10px rgba(0, 0, 0, 0.2),
    10px 10px 15px rgba(0, 0, 0, 0.1);
}

.link-underline-regular {
  @apply relative lg:mx-4 transition-colors duration-300 ease-in-out
          before:absolute before:bottom-0 before:left-0 before:h-0.5 before:w-0 before:bg-amber-400 
          before:transition-all before:duration-300 hover:before:w-full inline h-6 text-sm
           caret-transparent cursor-pointer;
}
.pseudos-links-regular {
  @apply active:text-amber-600 transition-colors duration-250;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 4px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: #fbbf24;
  border-radius: 10px;
}

.dark .custom-scrollbar::-webkit-scrollbar-thumb {
  background: #f59e0b;
}
